"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([[9162],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>y});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),h=a,y=p["".concat(l,".").concat(h)]||p[h]||d[h]||r;return n?o.createElement(y,i(i({ref:t},c),{},{components:n})):o.createElement(y,i({ref:t},c))}));function y(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:a,i[1]=s;for(var u=2;u<r;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},44381:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var o=n(87462),a=(n(67294),n(3905));const r={title:"Security",template:"docs",taxonomy:{category:"docs"},routes:{default:"/security"}},i=void 0,s={unversionedId:"administer/tutorials/security",id:"administer/tutorials/security",title:"Security",description:"YunoHost has been developed to provide the best security without too much complication. Every protocol used in YunoHost is encrypted, only a password's hashes are stored and by default each user is able to access their personal directory only.",source:"@site/docs/02.administer/45.tutorials/60.security.md",sourceDirName:"02.administer/45.tutorials",slug:"/administer/tutorials/security",permalink:"/yunodocusaurus/ca/docs/administer/tutorials/security",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02.administer/45.tutorials/60.security.md",tags:[],version:"current",sidebarPosition:60,frontMatter:{title:"Security",template:"docs",taxonomy:{category:"docs"},routes:{default:"/security"}},sidebar:"tutorialSidebar",previous:{title:"Moving an app folder to a different storage",permalink:"/yunodocusaurus/ca/docs/administer/tutorials/moving_app_folder"},next:{title:"Give SFTP permission to edit an app",permalink:"/yunodocusaurus/ca/docs/administer/tutorials/sftp_on_apps"}},l={},u=[{value:"Improve security",id:"improve-security",level:2},{value:"SSH authentication via key",id:"ssh-authentication-via-key",level:3},{value:"Modify the SSH port",id:"modify-the-ssh-port",level:3},{value:"Change cipher compatibility configuration",id:"change-cipher-compatibility-configuration",level:3},{value:"Disable the YunoHost API",id:"disable-the-yunohost-api",level:3}],c={toc:u},p="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(p,(0,o.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"YunoHost has been developed to provide the best security without too much complication. Every protocol used in YunoHost is ",(0,a.kt)("strong",{parentName:"p"},"encrypted"),", only a password's hashes are stored and by default each user is able to access their personal directory only."),(0,a.kt)("p",null,"Two things remain important to note:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Installing additional apps can ",(0,a.kt)("strong",{parentName:"p"},"significantly increase")," the number of potential security flaws. Do not hesitate to get information about security flaws ",(0,a.kt)("strong",{parentName:"p"},"before installing an app"),", and try to only install apps which will suit your needs.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"The fact that YunoHost is a well-known and used piece of software increases the chances of an attack. If a flaw is discovered, it could potentially affect all YunoHost instances at once. Keep your system ",(0,a.kt)("strong",{parentName:"p"},"up-to-date")," to remain safe. Updates can be automated by installing the ",(0,a.kt)("a",{parentName:"p",href:"https://install-app.yunohost.org/?app=unattended_upgrades"},'"Unattended_upgrades" app'),"."))),(0,a.kt)("p",null,"!!!! If you need advice, do not hesitate to ",(0,a.kt)("a",{parentName:"p",href:"/help"},"ask us"),"."),(0,a.kt)("p",null,"!! ","[fa=shield /]"," To discuss security flaws, contact the ",(0,a.kt)("a",{parentName:"p",href:"/security_team"},"YunoHost security team"),"."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"improve-security"},"Improve security"),(0,a.kt)("p",null,"If your YunoHost server is used in a critical production environment, or if you want to improve its safety, you may want to follow these good practices."),(0,a.kt)("p",null,"! ",(0,a.kt)("strong",{parentName:"p"},"WARNING:")," Following these instructions requires advanced knowledge of system administration."),(0,a.kt)("p",null,"!!!! ",(0,a.kt)("strong",{parentName:"p"},"TIP")," Never close your current SSH connection before checking that your alterations work. Test your new configuration by opening a new terminal or window. That way, you can undo your alterations if anything goes wrong."),(0,a.kt)("h3",{id:"ssh-authentication-via-key"},"SSH authentication via key"),(0,a.kt)("p",null,"By default, the SSH authentication uses the administration password. Deactivating this kind of authentication and replacing it by a key mechanism is advised."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"On your client"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ssh-keygen\nssh-copy-id -i ~/.ssh/id_rsa.pub <username@your_yunohost_server>\n")),(0,a.kt)("p",null,"!!! If you run into permissions issues, set ",(0,a.kt)("inlineCode",{parentName:"p"},"username")," as owner of the dir ",(0,a.kt)("inlineCode",{parentName:"p"},"~/.ssh")," with ",(0,a.kt)("inlineCode",{parentName:"p"},"chown"),". Be careful, for security reasons this directory should be in mode ",(0,a.kt)("inlineCode",{parentName:"p"},"700"),"."),(0,a.kt)("p",null,"!!! If you are on Ubuntu 16.04 you should run ",(0,a.kt)("inlineCode",{parentName:"p"},"ssh-add")," to initialize the SSH agent."),(0,a.kt)("p",null,"Type your admnistration password and your key will be copied onto your server."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"On your server"),", editing the SSH configuration file to deactivate password authentication is handled by a system setting:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost settings set security.ssh.password_authentication -v no\n")),(0,a.kt)("hr",null),(0,a.kt)("h3",{id:"modify-the-ssh-port"},"Modify the SSH port"),(0,a.kt)("p",null,"To prevent SSH connection attempts by robots that scan the internet for any server with SSH enabled, you can change the SSH port.\nThis is handled by a system setting, which takes care of updating the SSH and Fail2Ban configuration."),(0,a.kt)("p",null,"! If you modify anything in the ",(0,a.kt)("inlineCode",{parentName:"p"},"/etc/ssh/sshd_config")," file, even if only the port, YunoHost will no longer manage this file. For this reason, always use the YunoHost admin tools to make changes to the systems configuration files!"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost settings set security.ssh.port -v <new_ssh_port_number>\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"For subsequent SSH connections"),", you need to add the ",(0,a.kt)("inlineCode",{parentName:"p"},"-p")," option followed by the SSH port number."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Sample"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ssh -p <new_ssh_port_number> admin@<your_yunohost_server>\n")),(0,a.kt)("hr",null),(0,a.kt)("h3",{id:"change-cipher-compatibility-configuration"},"Change cipher compatibility configuration"),(0,a.kt)("p",null,"The default TLS configuration for services tends to offer good compatibility to support old devices. You can tune this policy for specific services like SSH and NGINX. By default, the NGINX configuration follows the ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.mozilla.org/Security/Server_Side_TLS#Intermediate_compatibility_.28default.29"},"intermediate compatibility recommendation")," from Mozilla. You can choose to switch to the 'modern' configuration which uses more recent security recommendations, but decreases compatibility, which may be an issue for your users and visitors using older devices. More details about compatibility can be found on ",(0,a.kt)("a",{parentName:"p",href:"https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility"},"this page"),"."),(0,a.kt)("p",null,"Changing the compatibility level is not definitive and can be reverted if it doesn't fit with your environment."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"On your server"),", change the policy for NGINX"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost settings set security.nginx.compatibility -v modern\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"On your server"),", change the policy for SSH"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost settings set security.ssh.compatibility -v modern\n")),(0,a.kt)("h3",{id:"disable-the-yunohost-api"},"Disable the YunoHost API"),(0,a.kt)("p",null,"YunoHost administration is accessible through an ",(0,a.kt)("strong",{parentName:"p"},"HTTP API"),", served on the 6787 port by default (only on ",(0,a.kt)("inlineCode",{parentName:"p"},"localhost"),").\nIt can be used to administer a lot of things on your server, so malicious actors can also use it to damage your server.\nThe best thing to do, if you know how to use the ",(0,a.kt)("a",{parentName:"p",href:"/commandline"},"command-line interface (CLI)"),", is to deactivate the ",(0,a.kt)("inlineCode",{parentName:"p"},"yunohost-api")," service."),(0,a.kt)("p",null,"! This will completely disable both YunoHost's API and the web administration panel that relies on it.\n! Proceed only if you are comfortable with the command line interface."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl disable yunohost-api\nsudo systemctl stop yunohost-api\n")),(0,a.kt)("p",null,"As ",(0,a.kt)("inlineCode",{parentName:"p"},"yunohost-api")," is now disabled and not running, Diagnosis will report an error and cannot be ignored from the API.\nIf you want to ignore this error, you can configure YunoHost from the CLI."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost diagnosis ignore --filter services service=yunohost-api\n")))}d.isMDXComponent=!0}}]);