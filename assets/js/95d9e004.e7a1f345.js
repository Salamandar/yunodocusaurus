"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([[9486],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>m});var o=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=o.createContext({}),u=function(e){var t=o.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},c=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},f=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(r),f=n,m=p["".concat(s,".").concat(f)]||p[f]||d[f]||a;return r?o.createElement(m,i(i({ref:t},c),{},{components:r})):o.createElement(m,i({ref:t},c))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,i=new Array(a);i[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:n,i[1]=l;for(var u=2;u<a;u++)i[u]=r[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}f.displayName="MDXCreateElement"},74785:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var o=r(87462),n=(r(67294),r(3905));const a={title:"Configure port-forwarding",template:"docs",taxonomy:{category:"docs"},routes:{default:"/isp_box_config",aliases:["/port_forwarding"]}},i=void 0,l={unversionedId:"administer/install/isp_box_config",id:"administer/install/isp_box_config",title:"Configure port-forwarding",description:'If you are self-hosting at home and without a VPN, you need to forward ports on your home router ("Internet box"). The sketch below tries to briefly summarize the role and necessity of port forwarding when setting up a server at home.',source:"@site/docs/02.administer/10.install/15.isp_box_config.md",sourceDirName:"02.administer/10.install",slug:"/administer/install/isp_box_config",permalink:"/yunodocusaurus/docs/administer/install/isp_box_config",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02.administer/10.install/15.isp_box_config.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{title:"Configure port-forwarding",template:"docs",taxonomy:{category:"docs"},routes:{default:"/isp_box_config",aliases:["/port_forwarding"]}},sidebar:"tutorialSidebar",previous:{title:"Finding your server's local IP",permalink:"/yunodocusaurus/docs/administer/install/finding_the_local_ip"},next:{title:"DNS zone configuration",permalink:"/yunodocusaurus/docs/administer/install/dns_config"}},s={},u=[{value:"0. Diagnose ports opened",id:"0-diagnose-ports-opened",level:3},{value:"1. Access your box/router administration interface",id:"1-access-your-boxrouter-administration-interface",level:3},{value:"2. Find the local IP of your server",id:"2-find-the-local-ip-of-your-server",level:3},{value:"3. Forwarding ports",id:"3-forwarding-ports",level:3},{value:"Automatic port forwarding / UPnP",id:"automatic-port-forwarding--upnp",level:2}],c={toc:u},p="wrapper";function d(e){let{components:t,...r}=e;return(0,n.kt)(p,(0,o.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,'If you are self-hosting at home and without a VPN, you need to forward ports on your home router ("Internet box"). The sketch below tries to briefly summarize the role and necessity of port forwarding when setting up a server at home.'),(0,n.kt)("p",null,'[figure caption="Illustration of the importance of port-forwarding"]',(0,n.kt)("img",{parentName:"p",src:"image://portForwarding_en.png",alt:null}),"[/figure]"),(0,n.kt)("h3",{id:"0-diagnose-ports-opened"},"0. Diagnose ports opened"),(0,n.kt)("p",null,"The new diagnosis tool introduced in 3.8 can be used to diagnose that ports are\ncorrectly exposed."),(0,n.kt)("h3",{id:"1-access-your-boxrouter-administration-interface"},"1. Access your box/router administration interface"),(0,n.kt)("p",null,"Your box/router admin interface is usually reachable via ",(0,n.kt)("a",{parentName:"p",href:"http://192.168.0.1"},"http://192.168.0.1")," or ",(0,n.kt)("a",{parentName:"p",href:"http://192.168.1.1"},"http://192.168.1.1"),". Then, you will probably need to authenticate yourself the credentials given by your internet server provider."),(0,n.kt)("h3",{id:"2-find-the-local-ip-of-your-server"},"2. Find the local IP of your server"),(0,n.kt)("p",null,"Identify what is thei ",(0,n.kt)("em",{parentName:"p"},"local")," IP of your server, either :"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"from your box/router interface, which might list devices connected"),(0,n.kt)("li",{parentName:"ul"},"from the YunoHost webadmin, in 'Diagnosis', section 'Internet connectivity', click on 'Details' on the IPv4 report."),(0,n.kt)("li",{parentName:"ul"},"from the command line in your server, by running ",(0,n.kt)("inlineCode",{parentName:"li"},"hostname -I"))),(0,n.kt)("p",null,"A local IP address typically looks like ",(0,n.kt)("inlineCode",{parentName:"p"},"192.168.xx.yy"),", or ",(0,n.kt)("inlineCode",{parentName:"p"},"10.0.xx.yy"),"."),(0,n.kt)("p",null,"The local IP address needs to be static, so that the port forwards that you are going to configure in the next step will always reach your server. You should go into your box/router and make sure that the local IP address of your server is static instead of dynamic."),(0,n.kt)("h3",{id:"3-forwarding-ports"},"3. Forwarding ports"),(0,n.kt)("p",null,"In your router admin interface, look for something like 'router configuration' or 'port forwarding'. The naming differs among the various kinds of boxes."),(0,n.kt)("p",null,"Opening the ports listed below is necessary for the various services available in YunoHost to work. For each of them, the 'TCP' forwarding is needed. Some interfaces refer to 'external' and 'internal' ports : these are the same in our case."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Web: 80 ",(0,n.kt)("small",null,"(HTTP)"),", 443 ",(0,n.kt)("small",null,"(HTTPS)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/ssh"},"SSH"),": 22"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/XMPP"},"XMPP"),": 5222 ",(0,n.kt)("small",null,"(clients)"),", 5269 ",(0,n.kt)("small",null,"(servers)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/email"},"Email"),": 25, 587 ",(0,n.kt)("small",null,"(SMTP)"),", 993 ",(0,n.kt)("small",null,"(IMAP)"))),(0,n.kt)("p",null,"If you use both a modem and a router, then you need to do the following:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"first on the modem (the box closest to the internet) create rules to forward the above ports to your router;"),(0,n.kt)("li",{parentName:"ol"},"then on the router (the box between the modem and your devices) create rules to forward the above ports to the static IP address for your server.")),(0,n.kt)("p",null,"! ","[fa=exclamation-triangle /]"," Some internet service providers block port 25 (mail SMTP) by default to fight spam. Some other ISP don't allow to use port 80/443 (web) freely, though it's less likely. Depending on the ISP, it might be possible to open them in the admin interface... Check ",(0,n.kt)("a",{parentName:"p",href:"/isp"},"this page")," for more info."),(0,n.kt)("h2",{id:"automatic-port-forwarding--upnp"},"Automatic port forwarding / UPnP"),(0,n.kt)("p",null,"A technology called UPnP is available on some internet boxes / routers and allows to automatically forward ports by the machine who needs them. If UPnP is enabled in your local network, then running this command should automatically open the port for you :"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost firewall reload\n")))}d.isMDXComponent=!0}}]);