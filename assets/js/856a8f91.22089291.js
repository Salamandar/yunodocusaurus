"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([[8036],{3905:(e,t,o)=>{o.d(t,{Zo:()=>p,kt:()=>b});var n=o(67294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function s(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function c(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var u=n.createContext({}),i=function(e){var t=n.useContext(u),o=t;return e&&(o="function"==typeof e?e(t):s(s({},t),e)),o},p=function(e){var t=i(e.components);return n.createElement(u.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},l=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,u=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),d=i(o),l=a,b=d["".concat(u,".").concat(l)]||d[l]||m[l]||r;return o?n.createElement(b,s(s({ref:t},p),{},{components:o})):n.createElement(b,s({ref:t},p))}));function b(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,s=new Array(r);s[0]=l;var c={};for(var u in t)hasOwnProperty.call(t,u)&&(c[u]=t[u]);c.originalType=e,c[d]="string"==typeof e?e:a,s[1]=c;for(var i=2;i<r;i++)s[i]=o[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,o)}l.displayName="MDXCreateElement"},84477:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>u,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>c,toc:()=>i});var n=o(87462),a=(o(67294),o(3905));const r={title:"Custom backup methods",template:"docs",taxonomy:{category:"docs"},routes:{default:"/backup/custom_backup_methods"},"page-toc":{active:!0,depth:3}},s=void 0,c={unversionedId:"administer/backups/backup_methods/custom_backup_methods",id:"administer/backups/backup_methods/custom_backup_methods",title:"Custom backup methods",description:"It is possible to create your own backup method and link it to YunoHost's backup file collection system. This can be useful if you want to use your own backup software or conduct disk mount/dismount operations for example.",source:"@site/docs/02.administer/20.backups/10.backup_methods/30.custom_backup_methods.md",sourceDirName:"02.administer/20.backups/10.backup_methods",slug:"/administer/backups/backup_methods/custom_backup_methods",permalink:"/yunodocusaurus/docs/administer/backups/backup_methods/custom_backup_methods",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02.administer/20.backups/10.backup_methods/30.custom_backup_methods.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{title:"Custom backup methods",template:"docs",taxonomy:{category:"docs"},routes:{default:"/backup/custom_backup_methods"},"page-toc":{active:!0,depth:3}},sidebar:"docsSidebar",previous:{title:"Archivist",permalink:"/yunodocusaurus/docs/administer/backups/backup_methods/archivist"},next:{title:"Create a filesystem image",permalink:"/yunodocusaurus/docs/administer/backups/clone_filesystem"}},u={},i=[],p={toc:i},d="wrapper";function m(e){let{components:t,...o}=e;return(0,a.kt)(d,(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"It is possible to create your own backup method and link it to YunoHost's backup file collection system. This can be useful if you want to use your own backup software or conduct disk mount/dismount operations for example."),(0,a.kt)("p",null,"This operation is done with a hook and will allow you to launch a backup this way:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"yunohost backup create --method custom\n")),(0,a.kt)("p",null,"Below is a simplistic example that can be used to set up a rotational backup with different disks that are changed every week:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="/etc/yunohost/hooks.d/backup_method/05-custom"',title:'"/etc/yunohost/hooks.d/backup_method/05-custom"'},'#!/bin/bash\nset -euo pipefail\n\nwork_dir="$2"\nname="$3"\nrepo="$4"\nsize="$5"\ndescription="$6"\n\ncase "$1" in\n  need_mount)\n    # Set false if your method can itself put files in good place in your archive\n    true\n    ;;\n  backup)\n    mount /dev/sda1 /mnt/hdd\n    if [[ "$(df /mnt/hdd | tail -n1 | cut -d" " -f1)" != "/dev/sda1" ]]\n    then\n        exit 1\n    fi\n    pushd "$work_dir"\n    current_date=$(date +"%Y-%m-%d_%H:%M")\n    cp -a "${work_dir}" "/mnt/hdd/${current_date}_$name"\n    popd\n    umount /mnt/hdd\n    ;;\n  *)\n    echo "hook called with unknown argument \\`$1\'" >&2\n    exit 1\n    ;;\nesac\n\nexit 0\n')))}m.isMDXComponent=!0}}]);