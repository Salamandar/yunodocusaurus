"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([[2091],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>f});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var l=r.createContext({}),c=function(e){var t=r.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(a),p=n,f=d["".concat(l,".").concat(p)]||d[p]||m[p]||i;return a?r.createElement(f,o(o({ref:t},u),{},{components:a})):r.createElement(f,o({ref:t},u))}));function f(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,o=new Array(i);o[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:n,o[1]=s;for(var c=2;c<i;c++)o[c]=a[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,a)}p.displayName="MDXCreateElement"},18679:(e,t,a)=>{a.d(t,{Z:()=>o});var r=a(67294),n=a(86010);const i={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:a,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,n.Z)(i.tabItem,o),hidden:a},t)}},73992:(e,t,a)=>{a.d(t,{Z:()=>w});var r=a(87462),n=a(67294),i=a(86010),o=a(72957),s=a(16550),l=a(75238),c=a(33609),u=a(92560);function d(e){return function(e){return n.Children.map(e,(e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:a,attributes:r,default:n}}=e;return{value:t,label:a,attributes:r,default:n}}))}function m(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??d(a);return function(e){const t=(0,c.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function p(e){let{value:t,tabValues:a}=e;return a.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:a}=e;const r=(0,s.k6)(),i=function(e){let{queryString:t=!1,groupId:a}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:t,groupId:a});return[(0,l._X)(i),(0,n.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(r.location.search);t.set(i,e),r.replace({...r.location,search:t.toString()})}),[i,r])]}function h(e){const{defaultValue:t,queryString:a=!1,groupId:r}=e,i=m(e),[o,s]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const r=a.find((e=>e.default))??a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:t,tabValues:i}))),[l,c]=f({queryString:a,groupId:r}),[d,h]=function(e){let{groupId:t}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,i]=(0,u.Nk)(a);return[r,(0,n.useCallback)((e=>{a&&i.set(e)}),[a,i])]}({groupId:r}),y=(()=>{const e=l??d;return p({value:e,tabValues:i})?e:null})();(0,n.useLayoutEffect)((()=>{y&&s(y)}),[y]);return{selectedValue:o,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),c(e),h(e)}),[c,h,i]),tabValues:i}}var y=a(51048);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function g(e){let{className:t,block:a,selectedValue:s,selectValue:l,tabValues:c}=e;const u=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.o5)(),m=e=>{const t=e.currentTarget,a=u.indexOf(t),r=c[a].value;r!==s&&(d(t),l(r))},p=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const a=u.indexOf(e.currentTarget)+1;t=u[a]??u[0];break}case"ArrowLeft":{const a=u.indexOf(e.currentTarget)-1;t=u[a]??u[u.length-1];break}}t?.focus()};return n.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":a},t)},c.map((e=>{let{value:t,label:a,attributes:o}=e;return n.createElement("li",(0,r.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>u.push(e),onKeyDown:p,onClick:m},o,{className:(0,i.Z)("tabs__item",b.tabItem,o?.className,{"tabs__item--active":s===t})}),a??t)})))}function k(e){let{lazy:t,children:a,selectedValue:r}=e;const i=(Array.isArray(a)?a:[a]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===r));return e?(0,n.cloneElement)(e,{className:"margin-top--md"}):null}return n.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==r}))))}function v(e){const t=h(e);return n.createElement("div",{className:(0,i.Z)("tabs-container",b.tabList)},n.createElement(g,(0,r.Z)({},e,t)),n.createElement(k,(0,r.Z)({},e,t)))}function w(e){const t=(0,y.Z)();return n.createElement(v,(0,r.Z)({key:String(t)},e))}},83171:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>l,default:()=>f,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var r=a(87462),n=(a(67294),a(3905)),i=a(73992),o=a(18679);const s={title:"Certificate",template:"docs",taxonomy:{category:"docs"},routes:{default:"/certificate"}},l=void 0,c={unversionedId:"administer/admin_guide/domains/certificate",id:"administer/admin_guide/domains/certificate",title:"Certificate",description:"Certificates are used to guarantee the confidentiality and authenticity of the communication between a web browser and your server. In particular, they protect against attackers trying to impersonate your server.",source:"@site/docs/02.administer/15.admin_guide/25.domains/certificate.mdx",sourceDirName:"02.administer/15.admin_guide/25.domains",slug:"/administer/admin_guide/domains/certificate",permalink:"/yunodocusaurus/docs/administer/admin_guide/domains/certificate",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02.administer/15.admin_guide/25.domains/certificate.mdx",tags:[],version:"current",frontMatter:{title:"Certificate",template:"docs",taxonomy:{category:"docs"},routes:{default:"/certificate"}},sidebar:"docsSidebar",previous:{title:"Domains",permalink:"/yunodocusaurus/docs/administer/admin_guide/domains/"},next:{title:"Applications",permalink:"/yunodocusaurus/docs/administer/admin_guide/apps"}},u={},d=[{value:"Install a Let&#39;s Encrypt certificate",id:"install-a-lets-encrypt-certificate",level:3},{value:"Troubleshooting",id:"troubleshooting",level:5}],m={toc:d},p="wrapper";function f(e){let{components:t,...s}=e;return(0,n.kt)(p,(0,r.Z)({},m,s,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Certificates are used to guarantee the confidentiality and authenticity of the communication between a web browser and your server. In particular, they protect against attackers trying to impersonate your server."),(0,n.kt)("p",null,"YunoHost provides a ",(0,n.kt)("strong",{parentName:"p"},"self-signed")," certificate, it means that your server guaranties the certificate validity. It's enough ",(0,n.kt)("strong",{parentName:"p"},"for personal usage"),", because you trust your own server. But this could be a problem if you want to open access to anonymous like web user for a website."),(0,n.kt)("p",null,"In practice, visitors will see a screen list this:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(45805).Z,width:"796",height:"522"})),(0,n.kt)("p",null,"Which basically asks the visitor : ",(0,n.kt)("strong",{parentName:"p"},'"Do you trust the server hosting this website?"'),". This can rightfully frighten a lot of people."),(0,n.kt)("p",null,"To avoid this confusion, it's possible to get a certificate signed a known authority named ",(0,n.kt)("strong",{parentName:"p"},"Let's Encrypt")," which provide free certificates directly recognized by browsers. YunoHost allows to directly install this certificate from the web administration interface or from the command line."),(0,n.kt)("h3",{id:"install-a-lets-encrypt-certificate"},"Install a Let's Encrypt certificate"),(0,n.kt)("p",null,"Before attempting to install a Let's Encrypt certificate, you should make sure that your DNS is correctly configured (your.domain.tld should point to your server's IP) and that your domain is accessible through HTTP from outside your local network (i.e. at least port 80 should be forwarded to your server)."),(0,n.kt)(i.Z,{groupId:"admin-commands",mdxType:"Tabs"},(0,n.kt)(o.Z,{value:"web",label:"From the web interface",mdxType:"TabItem"},(0,n.kt)("p",null,"Go to the 'Domain' part of the admin interface, then in the section dedicated to your.domain.tld. You should find a 'SSL certificate' button:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(2658).Z,width:"341",height:"675"})),(0,n.kt)("p",null,"In the 'SSL certificate' section, you can see the status of the current certificate. If you just added the domain, it should be a self-signed certificate."),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(67256).Z,width:"1131",height:"536"})),(0,n.kt)("p",null,"If your domain is correctly configured, it is then possible to install the Let's Encrypt certificate via the green button."),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(80347).Z,width:"1132",height:"494"})),(0,n.kt)("p",null,"Once the install is made, you can check that the certificate is live via your browser by going to your domain in HTTPS. The certificate will automatically be renewed every three months."),(0,n.kt)("p",null,(0,n.kt)("img",{src:a(34368).Z,width:"418",height:"201"}))),(0,n.kt)(o.Z,{value:"cli",label:"From the command line",mdxType:"TabItem"},(0,n.kt)("p",null,"Connect to your server through SSH."),(0,n.kt)("p",null,"You can check the status of your current certificate with:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yunohost domain cert-status your.domain.tld\n")),(0,n.kt)("p",null,"Install a Let's Encrypt certificate with"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yunohost domain cert-install your.domain.tld\n")),(0,n.kt)("p",null,"This should return :"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"Success! The SSOwat configuration has been generated\nSuccess! Successfully installed Let\\'s Encrypt certificate for domain DOMAIN.TLD!\n")),(0,n.kt)("p",null,"Once this is done, you can check that the certificate is live via your browser by going to your domain in HTTPS. The certificate will automatically be renewed every three months."))),(0,n.kt)("h5",{id:"troubleshooting"},"Troubleshooting"),(0,n.kt)("p",null,"If due to some bad tweaking, your certificate ends up in a bad state (e.g. lost the certificate or unable to read the files), you should be able to clean the situation by regenerating a self-signed certificate:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"yunohost domain cert-install your.domain.tld --self-signed --force\n")),(0,n.kt)("p",null,"If YunoHost thinks that your domain is badly configured despite the fact that you checked the DNS configuration and you have access in HTTP to your server from outside your local network, then you can:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"add a line ",(0,n.kt)("inlineCode",{parentName:"li"},"127.0.0.1 your.domain.tld")," to the file ",(0,n.kt)("inlineCode",{parentName:"li"},"/etc/hosts")," on your server;"),(0,n.kt)("li",{parentName:"ul"},"if the certificate installation still doesn't work, you can disable the checks with ",(0,n.kt)("inlineCode",{parentName:"li"},"--no-checks")," after the ",(0,n.kt)("inlineCode",{parentName:"li"},"cert-install")," command.")))}f.isMDXComponent=!0},80347:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/certificate-after-LE-3d6e3fd11aea419606e8c6b6af9359c3.png"},67256:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/certificate-before-LE-b508eea8886858f1e489c2eb347a54f7.png"},34368:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/certificate-signed-by-LE-13340bc35e67f988903a28bf6873c6e8.png"},2658:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/domain-certificate-button-b03482f077ef5a4489c9e38d99905dad.png"},45805:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/postinstall_error-31a7938f99e11c8285f1977498b32154.png"}}]);