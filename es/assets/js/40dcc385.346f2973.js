"use strict";(self.webpackChunkyunohost_docs=self.webpackChunkyunohost_docs||[]).push([[1848],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>p});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),u=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=u(a),m=r,p=c["".concat(l,".").concat(m)]||c[m]||h[m]||i;return a?n.createElement(p,o(o({ref:t},d),{},{components:a})):n.createElement(p,o({ref:t},d))}));function p(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:r,o[1]=s;for(var u=2;u<i;u++)o[u]=a[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},85234:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var n=a(87462),r=(a(67294),a(3905));const i={title:"Migrating from 3.x to 4.x",template:"docs",taxonomy:{category:"docs"},routes:{default:"/stretch_buster_migration"}},o=void 0,s={unversionedId:"administer/admin_guide/upgrade/stretch_buster_migration",id:"administer/admin_guide/upgrade/stretch_buster_migration",title:"Migrating from 3.x to 4.x",description:"This page is dedicated to help you migrating an instance from YunoHost 3.8.x (running on Debian Stretch/9.x) to YunoHost 4.x (running on Debian Buster/10.x).",source:"@site/docs/02.administer/15.admin_guide/55.upgrade/10.stretch_buster_migration.md",sourceDirName:"02.administer/15.admin_guide/55.upgrade",slug:"/administer/admin_guide/upgrade/stretch_buster_migration",permalink:"/yunodocusaurus/es/docs/administer/admin_guide/upgrade/stretch_buster_migration",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/02.administer/15.admin_guide/55.upgrade/10.stretch_buster_migration.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{title:"Migrating from 3.x to 4.x",template:"docs",taxonomy:{category:"docs"},routes:{default:"/stretch_buster_migration"}},sidebar:"tutorialSidebar",previous:{title:"Migrating from 2.4+ to 3.x",permalink:"/yunodocusaurus/es/docs/administer/admin_guide/upgrade/jessie_stretch_migration"},next:{title:"Migrating from 4.x to 11.x",permalink:"/yunodocusaurus/es/docs/administer/admin_guide/upgrade/buster_bullseye_migration"}},l={},u=[{value:"Important notes",id:"important-notes",level:2},{value:"Migration procedure",id:"migration-procedure",level:2},{value:"From the webadmin",id:"from-the-webadmin",level:4},{value:"From the command line",id:"from-the-command-line",level:4},{value:"During the migration",id:"during-the-migration",level:2},{value:"If the migration crashed / failed at some point.",id:"if-the-migration-crashed--failed-at-some-point",level:4},{value:"What to do after the upgrade",id:"what-to-do-after-the-upgrade",level:2},{value:"Check that you actually are on Debian Buster and YunoHost 4.x",id:"check-that-you-actually-are-on-debian-buster-and-yunohost-4x",level:4},{value:"Check that no issue appeared in the diagnosis",id:"check-that-no-issue-appeared-in-the-diagnosis",level:4},{value:"Check that your applications are working",id:"check-that-your-applications-are-working",level:4},{value:"Current known (minor) issues after the migration",id:"current-known-minor-issues-after-the-migration",level:2}],d={toc:u},c="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This page is dedicated to help you migrating an instance from YunoHost 3.8.x (running on Debian Stretch/9.x) to YunoHost 4.x (running on Debian Buster/10.x)."),(0,r.kt)("h2",{id:"important-notes"},"Important notes"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The YunoHost team did its best to make sure that the migration is as smooth as possible and was tested over the course of several months in several cases.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"With that said, please be aware that this is a delicate operation. System administration is a complicated topic and covering every particular cases is quite hard. Therefore, if you host critical data and services, please ",(0,r.kt)("a",{parentName:"p",href:"/backup"},"make backups"),". And in any case, be patient and attentive during the migration.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Please don't rush into thinking that you should need to reinstall your system from scratch thinking it would be \"simpler\" (sigh). (A common attitude is to be willing to reinstall a server at the slightest complication...) Instead, if you happen to run into issues, we encourage you to try to investigate and understand what's going on and ",(0,r.kt)("a",{parentName:"p",href:"/help"},"reach for help on the chat and the forum"),"."))),(0,r.kt)("h2",{id:"migration-procedure"},"Migration procedure"),(0,r.kt)("h4",{id:"from-the-webadmin"},"From the webadmin"),(0,r.kt)("p",null,"After upgrading to 3.8.5.x, go to Tools > Migrations to access the migrations interface. You will have to read carefully and accept the disclaimer then launch the migration. "),(0,r.kt)("h4",{id:"from-the-command-line"},"From the command line"),(0,r.kt)("p",null,"After upgrading to 3.8.5.x, run : "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo yunohost tools migrations migrate\n")),(0,r.kt)("p",null,"then read carefully and accept the disclaimer."),(0,r.kt)("h2",{id:"during-the-migration"},"During the migration"),(0,r.kt)("p",null,"Depending on your hardware and packages installed, the migration might take up to a few hours. "),(0,r.kt)("p",null,"The logs will be shown in the message bar (you can hover it to see the whole history). They will also be available after the migration (like any other operations) in Tools > Logs."),(0,r.kt)("p",null,"Note that even if you close the webadmin page for some reason, the migration will continue in the background (but the webadmin will be partially unavailable)."),(0,r.kt)("h4",{id:"if-the-migration-crashed--failed-at-some-point"},"If the migration crashed / failed at some point."),(0,r.kt)("p",null,"If the migration failed at some point, it should be possible to relaunch it. If it still doesn't work, you can try to ",(0,r.kt)("a",{parentName:"p",href:"/help"},"get help")," (please provide the corresponding messages or whatever makes you tell that it's not working)."),(0,r.kt)("h2",{id:"what-to-do-after-the-upgrade"},"What to do after the upgrade"),(0,r.kt)("h4",{id:"check-that-you-actually-are-on-debian-buster-and-yunohost-4x"},"Check that you actually are on Debian Buster and YunoHost 4.x"),(0,r.kt)("p",null,"For this, go in Diagnosis (category Base system) or look at the footer of the webadmin. In the command line, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"lsb_release -a")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"yunohost --version"),"."),(0,r.kt)("h4",{id:"check-that-no-issue-appeared-in-the-diagnosis"},"Check that no issue appeared in the diagnosis"),(0,r.kt)("p",null,"Also in the Diagnosis in the webadmin, make sure that no specific issue appeared after running the migration (for example a service that crashed for some reason)."),(0,r.kt)("h4",{id:"check-that-your-applications-are-working"},"Check that your applications are working"),(0,r.kt)("p",null,"Test that your applications are working. If they aren't, you should try to upgrade them (it is also a good idea to upgrade them even if they are working anyway)."),(0,r.kt)("h2",{id:"current-known-minor-issues-after-the-migration"},"Current known (minor) issues after the migration"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Some file (",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/nsswitch.conf")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"/etc/nslcd.conf"),") will appear as manually modified after the migration. You can safely apply the regen-conf with: ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"yunohost tools regen-conf nsswitch nslcd --force\n")),(0,r.kt)("p",null,"(we will try to do this automatically somehow)"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Sometimes the postgresql migration (that is supposed to happen automatically after the buster migration is ran) fails to run properly... Some users reported that re-launching manually the postgresql migration fixed the issue (we will try to understand and fix this somehow)")))}h.isMDXComponent=!0}}]);